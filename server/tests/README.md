# ポケモンバトルシステム テスト

このディレクトリには、ポケモンバトルシステムの各種テストファイルが含まれています。

## テストファイル

### `battle-system.test.ts`
メインのバトルシステム統合テストファイルです。

#### 含まれるテスト:

1. **攻撃ハンドラーテスト**
   - 物理攻撃の処理
   - 特殊攻撃の処理
   - ダメージ計算の確認

2. **状態異常ハンドラーテスト**
   - 基本的な状態異常処理（毒・麻痺）
   - 詳細な状態異常テスト（複数ターン検証）
     - 毒状態の複数ターンダメージ
     - 麻痺状態の行動可能率統計
     - 眠り状態の自然回復
     - 火傷状態の継続ダメージ
     - 凍り状態の自然回復
     - 混乱状態の自傷・行動不能率
     - 状態異常の治癒メカニズム

3. **交代ハンドラーテスト**
   - 正常な交代処理
   - 交代不可能ケースの判定

4. **バトルフロー統合テスト**
   - 複雑なバトルシナリオの実行
   - 複数ターンにわたるバトル進行
   - 勝敗判定の確認

5. **バトルシミュレーション**
   - 12種類の異なるバトルシナリオ
   - 様々なポケモンの組み合わせ
   - 状態異常を持つポケモンのバトル
   - 複数体のポケモンによるバトル

## テスト実行方法

```bash
# TypeScriptを直接実行
cd /home/cs23017/game/pkcv2/server
node -r ts-node/register tests/battle-system.test.ts

# または npx を使用
npx ts-node tests/battle-system.test.ts
```

## テスト結果の見方

テストは以下の形式で結果を表示します：

- ✓ : テスト成功
- ✗ : テスト失敗
- 📊 : 統計情報
- 🎉 : テスト完了

各状態異常テストでは確率的な処理の統計分析も行われ、理論値と実測値の比較が表示されます。

## 対象システム

- **攻撃システム**: 物理・特殊攻撃のダメージ計算
- **状態異常システム**: 毒・麻痺・眠り・火傷・凍り・混乱の処理
- **交代システム**: ポケモンの交代処理
- **バトルフローシステム**: 総合的なバトル進行制御

## モックデータ

テストでは以下のモック技を使用しています：
- でんこうせっか（物理攻撃）
- たいあたり（物理攻撃）
- はかいこうせん（特殊攻撃）
- どくどく（毒状態異常）
- でんじは（麻痺状態異常）
- ねむりごな（眠り状態異常）
- かえんほうしゃ（火傷付与攻撃）
- れいとうビーム（凍り付与攻撃）
- あやしいひかり（混乱状態異常）
